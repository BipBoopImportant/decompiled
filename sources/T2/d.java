package T2;

import R2.n;
import R2.w;
import R2.x;
import WK.C16762E;
import WK.C16777l;
import XH.C16807N;
import XH.C16824o;
import XH.C16825p;
import java.util.LinkedHashSet;
import java.util.Set;
import kotlin.Metadata;
import kotlin.jvm.internal.C17542s;
import kotlin.jvm.internal.C17544u;
import kotlin.jvm.internal.DefaultConstructorMarker;
import nI.C17631a;
import nI.p;

@Metadata(d1 = {"\u00004\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\b\u0003\n\u0002\u0018\u0002\n\u0002\b\u000f\u0018\u0000 \u001b*\u0004\b\u0000\u0010\u00012\b\u0012\u0004\u0012\u00028\u00000\u0002:\u0001\u0013BG\u0012\u0006\u0010\u0004\u001a\u00020\u0003\u0012\f\u0010\u0006\u001a\b\u0012\u0004\u0012\u00028\u00000\u0005\u0012\u001a\b\u0002\u0010\n\u001a\u0014\u0012\u0004\u0012\u00020\b\u0012\u0004\u0012\u00020\u0003\u0012\u0004\u0012\u00020\t0\u0007\u0012\f\u0010\f\u001a\b\u0012\u0004\u0012\u00020\b0\u000b¢\u0006\u0004\b\r\u0010\u000eJ\u0015\u0010\u0010\u001a\b\u0012\u0004\u0012\u00028\u00000\u000fH\u0016¢\u0006\u0004\b\u0010\u0010\u0011R\u0014\u0010\u0004\u001a\u00020\u00038\u0002X\u0004¢\u0006\u0006\n\u0004\b\u0010\u0010\u0012R\u001a\u0010\u0006\u001a\b\u0012\u0004\u0012\u00028\u00000\u00058\u0002X\u0004¢\u0006\u0006\n\u0004\b\u0013\u0010\u0014R&\u0010\n\u001a\u0014\u0012\u0004\u0012\u00020\b\u0012\u0004\u0012\u00020\u0003\u0012\u0004\u0012\u00020\t0\u00078\u0002X\u0004¢\u0006\u0006\n\u0004\b\u0015\u0010\u0016R\u001a\u0010\f\u001a\b\u0012\u0004\u0012\u00020\b0\u000b8\u0002X\u0004¢\u0006\u0006\n\u0004\b\u0017\u0010\u0018R\u001b\u0010\u001d\u001a\u00020\b8BX\u0002¢\u0006\f\n\u0004\b\u0019\u0010\u001a\u001a\u0004\b\u001b\u0010\u001c¨\u0006\u001e"}, d2 = {"LT2/d;", "T", "LR2/w;", "LWK/l;", "fileSystem", "LT2/c;", "serializer", "Lkotlin/Function2;", "LWK/E;", "LR2/n;", "coordinatorProducer", "Lkotlin/Function0;", "producePath", "<init>", "(LWK/l;LT2/c;LnI/p;LnI/a;)V", "LR2/x;", "a", "()LR2/x;", "LWK/l;", "b", "LT2/c;", "c", "LnI/p;", "d", "LnI/a;", "e", "LXH/o;", "f", "()LWK/E;", "canonicalPath", "datastore-core-okio"}, k = 1, mv = {1, 8, 0}, xi = 48)
public final class d<T> implements w<T> {

    /* renamed from: f  reason: collision with root package name */
    public static final b f13672f = new b((DefaultConstructorMarker) null);
    /* access modifiers changed from: private */

    /* renamed from: g  reason: collision with root package name */
    public static final Set<String> f13673g = new LinkedHashSet();
    /* access modifiers changed from: private */

    /* renamed from: h  reason: collision with root package name */
    public static final h f13674h = new h();

    /* renamed from: a  reason: collision with root package name */
    private final C16777l f13675a;

    /* renamed from: b  reason: collision with root package name */
    private final c<T> f13676b;

    /* renamed from: c  reason: collision with root package name */
    private final p<C16762E, C16777l, n> f13677c;
    /* access modifiers changed from: private */

    /* renamed from: d  reason: collision with root package name */
    public final C17631a<C16762E> f13678d;

    /* renamed from: e  reason: collision with root package name */
    private final C16824o f13679e;

    @Metadata(d1 = {"\u0000\u0016\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\b\u0002\u0010\u0006\u001a\u00020\u0005\"\u0004\b\u0000\u0010\u00002\u0006\u0010\u0002\u001a\u00020\u00012\u0006\u0010\u0004\u001a\u00020\u0003H\n¢\u0006\u0004\b\u0006\u0010\u0007"}, d2 = {"T", "LWK/E;", "path", "LWK/l;", "<anonymous parameter 1>", "LR2/n;", "a", "(LWK/E;LWK/l;)LR2/n;"}, k = 3, mv = {1, 8, 0})
    static final class a extends C17544u implements p<C16762E, C16777l, n> {

        /* renamed from: c  reason: collision with root package name */
        public static final a f13680c = new a();

        a() {
            super(2);
        }

        /* renamed from: a */
        public final n invoke(C16762E e10, C16777l lVar) {
            C17542s.j(e10, "path");
            C17542s.j(lVar, "<anonymous parameter 1>");
            return f.a(e10);
        }
    }

    @Metadata(d1 = {"\u0000 \n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0002\b\u0002\n\u0002\u0010#\n\u0002\u0010\u000e\n\u0002\b\u0004\n\u0002\u0018\u0002\n\u0002\b\u0005\b\u0003\u0018\u00002\u00020\u0001B\t\b\u0002¢\u0006\u0004\b\u0002\u0010\u0003R \u0010\u0006\u001a\b\u0012\u0004\u0012\u00020\u00050\u00048\u0000X\u0004¢\u0006\f\n\u0004\b\u0006\u0010\u0007\u001a\u0004\b\b\u0010\tR\u0017\u0010\u000b\u001a\u00020\n8\u0006¢\u0006\f\n\u0004\b\u000b\u0010\f\u001a\u0004\b\r\u0010\u000e¨\u0006\u000f"}, d2 = {"LT2/d$b;", "", "<init>", "()V", "", "", "activeFiles", "Ljava/util/Set;", "a", "()Ljava/util/Set;", "LT2/h;", "activeFilesLock", "LT2/h;", "b", "()LT2/h;", "datastore-core-okio"}, k = 1, mv = {1, 8, 0}, xi = 48)
    public static final class b {
        public /* synthetic */ b(DefaultConstructorMarker defaultConstructorMarker) {
            this();
        }

        public final Set<String> a() {
            return d.f13673g;
        }

        public final h b() {
            return d.f13674h;
        }

        private b() {
        }
    }

    @Metadata(d1 = {"\u0000\n\n\u0000\n\u0002\u0018\u0002\n\u0002\b\u0002\u0010\u0002\u001a\u00020\u0001\"\u0004\b\u0000\u0010\u0000H\n¢\u0006\u0004\b\u0002\u0010\u0003"}, d2 = {"T", "LWK/E;", "b", "()LWK/E;"}, k = 3, mv = {1, 8, 0})
    static final class c extends C17544u implements C17631a<C16762E> {

        /* renamed from: c  reason: collision with root package name */
        final /* synthetic */ d<T> f13681c;

        /* JADX INFO: super call moved to the top of the method (can break code semantics) */
        c(d<T> dVar) {
            super(0);
            this.f13681c = dVar;
        }

        /* renamed from: b */
        public final C16762E invoke() {
            C16762E e10 = (C16762E) this.f13681c.f13678d.invoke();
            boolean n10 = e10.n();
            d<T> dVar = this.f13681c;
            if (n10) {
                return e10.C();
            }
            throw new IllegalStateException(("OkioStorage requires absolute paths, but did not get an absolute path from producePath = " + dVar.f13678d + ", instead got " + e10).toString());
        }
    }

    @Metadata(d1 = {"\u0000\n\n\u0000\n\u0002\u0018\u0002\n\u0002\b\u0003\u0010\u0004\u001a\u00020\u0001\"\u0004\b\u0000\u0010\u0000H\n¢\u0006\u0004\b\u0002\u0010\u0003"}, d2 = {"T", "LXH/N;", "invoke", "()V", "<anonymous>"}, k = 3, mv = {1, 8, 0})
    /* renamed from: T2.d$d  reason: collision with other inner class name */
    static final class C0201d extends C17544u implements C17631a<C16807N> {

        /* renamed from: c  reason: collision with root package name */
        final /* synthetic */ d<T> f13682c;

        /* JADX INFO: super call moved to the top of the method (can break code semantics) */
        C0201d(d<T> dVar) {
            super(0);
            this.f13682c = dVar;
        }

        public final void invoke() {
            b bVar = d.f13672f;
            h b10 = bVar.b();
            d<T> dVar = this.f13682c;
            synchronized (b10) {
                bVar.a().remove(dVar.f().toString());
                C16807N n10 = C16807N.f139792a;
            }
        }
    }

    public d(C16777l lVar, c<T> cVar, p<? super C16762E, ? super C16777l, ? extends n> pVar, C17631a<C16762E> aVar) {
        C17542s.j(lVar, "fileSystem");
        C17542s.j(cVar, "serializer");
        C17542s.j(pVar, "coordinatorProducer");
        C17542s.j(aVar, "producePath");
        this.f13675a = lVar;
        this.f13676b = cVar;
        this.f13677c = pVar;
        this.f13678d = aVar;
        this.f13679e = C16825p.b(new c(this));
    }

    /* access modifiers changed from: private */
    public final C16762E f() {
        return (C16762E) this.f13679e.getValue();
    }

    public x<T> a() {
        String e10 = f().toString();
        synchronized (f13674h) {
            Set<String> set = f13673g;
            if (!set.contains(e10)) {
                set.add(e10);
            } else {
                throw new IllegalStateException(("There are multiple DataStores active for the same file: " + e10 + ". You should either maintain your DataStore as a singleton or confirm that there is no two DataStore's active on the same file (by confirming that the scope is cancelled).").toString());
            }
        }
        return new e(this.f13675a, f(), this.f13676b, this.f13677c.invoke(f(), this.f13675a), new C0201d(this));
    }

    /* JADX INFO: this call moved to the top of the method (can break code semantics) */
    public /* synthetic */ d(C16777l lVar, c cVar, p pVar, C17631a aVar, int i10, DefaultConstructorMarker defaultConstructorMarker) {
        this(lVar, cVar, (i10 & 4) != 0 ? a.f13680c : pVar, aVar);
    }
}
